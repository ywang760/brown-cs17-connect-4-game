// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var List = require("bs-platform/lib/js/list.js");
var Caml_obj = require("bs-platform/lib/js/caml_obj.js");
var Pervasives = require("bs-platform/lib/js/pervasives.js");
var Caml_format = require("bs-platform/lib/js/caml_format.js");
var CS17SetupGame$Game = require("./CS17SetupGame.bs.js");

function transpose(mat) {
  if (!mat) {
    return Pervasives.failwith("A matrix cannot be 0-dimensional.");
  }
  var match = mat.hd;
  if (match) {
    if (match.tl) {
      return {
              hd: List.map(List.hd, mat),
              tl: transpose(List.map(List.tl, mat))
            };
    } else {
      return {
              hd: List.flatten(mat),
              tl: /* [] */0
            };
    }
  } else {
    return Pervasives.failwith("A matrix cannot be 0-dimensional.");
  }
}

function duplicate(alod, $$int) {
  if ($$int !== 0) {
    return {
            hd: alod,
            tl: duplicate(alod, $$int - 1 | 0)
          };
  } else {
    return /* [] */0;
  }
}

function shear(mat) {
  if (!mat) {
    return Pervasives.failwith("A matrix cannot be 0-dimensional.");
  }
  var hd = mat.hd;
  if (!hd) {
    return Pervasives.failwith("A matrix cannot be 0-dimensional.");
  }
  if (!mat.tl) {
    return {
            hd: {
              hd: hd.hd,
              tl: hd.tl
            },
            tl: /* [] */0
          };
  }
  var tl = mat.tl;
  return {
          hd: List.append(hd, duplicate(3, List.length(tl))),
          tl: List.map((function (alod) {
                  return {
                          hd: 3,
                          tl: alod
                        };
                }), shear(tl))
        };
}

function initialState(s) {
  var boardDims = CS17SetupGame$Game.parseBoardDims(s);
  var boardHeight = CS17SetupGame$Game.getBoardHeight(boardDims);
  var boardWidth = CS17SetupGame$Game.getBoardWidth(boardDims);
  return /* State */{
          _0: {
            TAG: /* Ongoing */1,
            _0: /* P1 */0
          },
          _1: duplicate(duplicate(0, boardHeight), boardWidth)
        };
}

function stringOfPlayer(py) {
  if (py) {
    return "Player2";
  } else {
    return "Player1";
  }
}

function stringOfState(inState) {
  var printcolumn = function (column) {
    if (!column) {
      return "";
    }
    var tl = column.tl;
    var a = column.hd;
    if (tl) {
      return String(a) + (" " + printcolumn(tl));
    } else {
      return String(a);
    }
  };
  var printboard = function (board) {
    if (board) {
      return printcolumn(board.hd) + ("\n" + printboard(board.tl));
    } else {
      return "";
    }
  };
  return printboard(transpose(List.map(List.rev, inState._1)));
}

function stringOfMove($$int) {
  return String($$int._0);
}

function legalMoves(inState) {
  var legalHelper = function (_cols, _n) {
    while(true) {
      var n = _n;
      var cols = _cols;
      if (!cols) {
        return /* [] */0;
      }
      var tl = cols.tl;
      if (List.mem(0, cols.hd)) {
        return {
                hd: /* Move */{
                  _0: n + 1 | 0
                },
                tl: legalHelper(tl, n + 1 | 0)
              };
      }
      _n = n + 1 | 0;
      _cols = tl;
      continue ;
    };
  };
  var a = inState._1;
  if (a) {
    return legalHelper(a, 0);
  } else {
    return /* [] */0;
  }
}

function gameStatus(inState) {
  return inState._0;
}

function nextState(inState, mov) {
  var addingAPieceHelper = function (alod, n) {
    if (!alod) {
      return Pervasives.failwith("invalid move");
    }
    var tl = alod.tl;
    var hd = alod.hd;
    if (hd === 0) {
      return {
              hd: n,
              tl: tl
            };
    } else {
      return {
              hd: hd,
              tl: addingAPieceHelper(tl, n)
            };
    }
  };
  var addingAPiece = function (board, mov, num) {
    var mov$1 = mov._0;
    if (!board) {
      return Pervasives.failwith("invalid move");
    }
    var tl = board.tl;
    var hd = board.hd;
    if (mov$1 !== 1) {
      return {
              hd: hd,
              tl: addingAPiece(tl, /* Move */{
                    _0: mov$1 - 1 | 0
                  }, num)
            };
    } else {
      return {
              hd: addingAPieceHelper(hd, num),
              tl: tl
            };
    }
  };
  var columnWinDetectorHelper = function (_alod) {
    while(true) {
      var alod = _alod;
      if (!alod) {
        return false;
      }
      var _hd = alod.hd;
      if (_hd !== 1) {
        if (_hd !== 2) {
          _alod = alod.tl;
          continue ;
        }
        var match = alod.tl;
        if (match) {
          if (match.hd !== 2) {
            _alod = alod.tl;
            continue ;
          }
          var match$1 = match.tl;
          if (match$1) {
            if (match$1.hd !== 2) {
              _alod = alod.tl;
              continue ;
            }
            var match$2 = match$1.tl;
            if (match$2) {
              if (match$2.hd === 2) {
                return true;
              }
              _alod = alod.tl;
              continue ;
            }
            _alod = alod.tl;
            continue ;
          }
          _alod = alod.tl;
          continue ;
        }
        _alod = alod.tl;
        continue ;
      }
      var match$3 = alod.tl;
      if (match$3) {
        if (match$3.hd !== 1) {
          _alod = alod.tl;
          continue ;
        }
        var match$4 = match$3.tl;
        if (match$4) {
          if (match$4.hd !== 1) {
            _alod = alod.tl;
            continue ;
          }
          var match$5 = match$4.tl;
          if (match$5) {
            if (match$5.hd === 1) {
              return true;
            }
            _alod = alod.tl;
            continue ;
          }
          _alod = alod.tl;
          continue ;
        }
        _alod = alod.tl;
        continue ;
      }
      _alod = alod.tl;
      continue ;
    };
  };
  var winDetector = function (board) {
    if (List.exists(columnWinDetectorHelper, board) || List.exists(columnWinDetectorHelper, transpose(board)) || List.exists(columnWinDetectorHelper, transpose(shear(board)))) {
      return true;
    } else {
      return List.exists(columnWinDetectorHelper, transpose(shear(List.map(List.rev, board))));
    }
  };
  var match = legalMoves(inState);
  if (!match) {
    return /* State */{
            _0: /* Draw */0,
            _1: inState._1
          };
  }
  var match$1 = inState._0;
  if (typeof match$1 === "number") {
    return inState;
  }
  if (match$1.TAG === /* Win */0) {
    return inState;
  }
  if (match$1._0) {
    var b2 = addingAPiece(inState._1, mov, 2);
    if (winDetector(b2)) {
      return /* State */{
              _0: {
                TAG: /* Win */0,
                _0: /* P2 */1
              },
              _1: b2
            };
    } else if (legalMoves(/* State */{
            _0: {
              TAG: /* Ongoing */1,
              _0: /* P1 */0
            },
            _1: b2
          }) === /* [] */0) {
      return /* State */{
              _0: /* Draw */0,
              _1: b2
            };
    } else {
      return /* State */{
              _0: {
                TAG: /* Ongoing */1,
                _0: /* P1 */0
              },
              _1: b2
            };
    }
  }
  var b1 = addingAPiece(inState._1, mov, 1);
  if (winDetector(b1)) {
    return /* State */{
            _0: {
              TAG: /* Win */0,
              _0: /* P1 */0
            },
            _1: b1
          };
  } else if (legalMoves(/* State */{
          _0: {
            TAG: /* Ongoing */1,
            _0: /* P2 */1
          },
          _1: b1
        }) === /* [] */0) {
    return /* State */{
            _0: /* Draw */0,
            _1: b1
          };
  } else {
    return /* State */{
            _0: {
              TAG: /* Ongoing */1,
              _0: /* P2 */1
            },
            _1: b1
          };
  }
}

function moveOfString(str, inState) {
  var match = Caml_format.caml_int_of_string(str);
  var match$1 = legalMoves(inState);
  if (List.mem(/* Move */{
          _0: match
        }, match$1)) {
    return /* Move */{
            _0: match
          };
  } else {
    return Pervasives.failwith("not a legal move");
  }
}

function score(lst, num, n) {
  if (!lst) {
    return num;
  }
  var search = function (_lst, _num, n) {
    while(true) {
      var num = _num;
      var lst = _lst;
      if (!lst) {
        return Pervasives.failwith("the list is too short");
      }
      var match = lst.tl;
      if (!match) {
        return Pervasives.failwith("the list is too short");
      }
      var match$1 = match.tl;
      if (!match$1) {
        return Pervasives.failwith("the list is too short");
      }
      var match$2 = match$1.tl;
      if (!match$2) {
        return num;
      }
      var _hd3 = match$1.hd;
      var _hd2 = match.hd;
      var _hd1 = lst.hd;
      var tl = match$2.tl;
      var hd4 = match$2.hd;
      var member = function (_lst, _sublst) {
        while(true) {
          var sublst = _sublst;
          var lst = _lst;
          if (!lst) {
            return false;
          }
          if (!sublst) {
            return Pervasives.failwith("sublst cannot be empty");
          }
          var tl2 = sublst.tl;
          var hd2 = sublst.hd;
          var tl = lst.tl;
          var hd1 = lst.hd;
          if (tl2) {
            if (hd1 === hd2) {
              _sublst = tl2;
              _lst = tl;
              continue ;
            }
            _lst = tl;
            continue ;
          }
          if (hd1 === hd2) {
            return true;
          }
          _sublst = {
            hd: hd2,
            tl: /* [] */0
          };
          _lst = tl;
          continue ;
        };
      };
      if (n === 1) {
        if (member({
                hd: _hd1,
                tl: {
                  hd: _hd2,
                  tl: {
                    hd: _hd3,
                    tl: {
                      hd: hd4,
                      tl: /* [] */0
                    }
                  }
                }
              }, {
                hd: 2,
                tl: /* [] */0
              })) {
          _lst = {
            hd: _hd2,
            tl: {
              hd: _hd3,
              tl: {
                hd: hd4,
                tl: tl
              }
            }
          };
          continue ;
        }
        if (Caml_obj.caml_equal({
                hd: _hd1,
                tl: {
                  hd: _hd2,
                  tl: {
                    hd: _hd3,
                    tl: {
                      hd: hd4,
                      tl: /* [] */0
                    }
                  }
                }
              }, {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 1,
                      tl: /* [] */0
                    }
                  }
                }
              }) || Caml_obj.caml_equal({
                hd: _hd1,
                tl: {
                  hd: _hd2,
                  tl: {
                    hd: _hd3,
                    tl: {
                      hd: hd4,
                      tl: /* [] */0
                    }
                  }
                }
              }, {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              })) {
          _num = num + 500000;
          _lst = {
            hd: _hd2,
            tl: {
              hd: _hd3,
              tl: {
                hd: hd4,
                tl: tl
              }
            }
          };
          continue ;
        }
        if (member({
                hd: _hd1,
                tl: {
                  hd: _hd2,
                  tl: {
                    hd: _hd3,
                    tl: {
                      hd: hd4,
                      tl: /* [] */0
                    }
                  }
                }
              }, {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              })) {
          _num = num + 100000;
          _lst = {
            hd: _hd2,
            tl: {
              hd: _hd3,
              tl: {
                hd: hd4,
                tl: tl
              }
            }
          };
          continue ;
        }
        if (member({
                hd: _hd1,
                tl: {
                  hd: _hd2,
                  tl: {
                    hd: _hd3,
                    tl: {
                      hd: hd4,
                      tl: /* [] */0
                    }
                  }
                }
              }, {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              })) {
          _num = num + 100;
          _lst = {
            hd: _hd2,
            tl: {
              hd: _hd3,
              tl: {
                hd: hd4,
                tl: tl
              }
            }
          };
          continue ;
        }
        if (member({
                hd: _hd1,
                tl: {
                  hd: _hd2,
                  tl: {
                    hd: _hd3,
                    tl: {
                      hd: hd4,
                      tl: /* [] */0
                    }
                  }
                }
              }, {
                hd: 1,
                tl: /* [] */0
              })) {
          _num = num + 10;
          _lst = {
            hd: _hd2,
            tl: {
              hd: _hd3,
              tl: {
                hd: hd4,
                tl: tl
              }
            }
          };
          continue ;
        }
        _lst = {
          hd: _hd2,
          tl: {
            hd: _hd3,
            tl: {
              hd: hd4,
              tl: tl
            }
          }
        };
        continue ;
      }
      if (n !== 2) {
        return Pervasives.failwith("there are only 2 players");
      }
      if (member({
              hd: _hd1,
              tl: {
                hd: _hd2,
                tl: {
                  hd: _hd3,
                  tl: {
                    hd: hd4,
                    tl: /* [] */0
                  }
                }
              }
            }, {
              hd: 1,
              tl: /* [] */0
            })) {
        _lst = {
          hd: _hd2,
          tl: {
            hd: _hd3,
            tl: {
              hd: hd4,
              tl: tl
            }
          }
        };
        continue ;
      }
      if (Caml_obj.caml_equal({
              hd: _hd1,
              tl: {
                hd: _hd2,
                tl: {
                  hd: _hd3,
                  tl: {
                    hd: hd4,
                    tl: /* [] */0
                  }
                }
              }
            }, {
              hd: 0,
              tl: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                }
              }
            }) || Caml_obj.caml_equal({
              hd: _hd1,
              tl: {
                hd: _hd2,
                tl: {
                  hd: _hd3,
                  tl: {
                    hd: hd4,
                    tl: /* [] */0
                  }
                }
              }
            }, {
              hd: 2,
              tl: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            })) {
        _num = num - 500000;
        _lst = {
          hd: _hd2,
          tl: {
            hd: _hd3,
            tl: {
              hd: hd4,
              tl: tl
            }
          }
        };
        continue ;
      }
      if (member({
              hd: _hd1,
              tl: {
                hd: _hd2,
                tl: {
                  hd: _hd3,
                  tl: {
                    hd: hd4,
                    tl: /* [] */0
                  }
                }
              }
            }, {
              hd: 2,
              tl: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: /* [] */0
                }
              }
            })) {
        _num = num - 100000;
        _lst = {
          hd: _hd2,
          tl: {
            hd: _hd3,
            tl: {
              hd: hd4,
              tl: tl
            }
          }
        };
        continue ;
      }
      if (member({
              hd: _hd1,
              tl: {
                hd: _hd2,
                tl: {
                  hd: _hd3,
                  tl: {
                    hd: hd4,
                    tl: /* [] */0
                  }
                }
              }
            }, {
              hd: 2,
              tl: {
                hd: 2,
                tl: /* [] */0
              }
            })) {
        _num = num - 100;
        _lst = {
          hd: _hd2,
          tl: {
            hd: _hd3,
            tl: {
              hd: hd4,
              tl: tl
            }
          }
        };
        continue ;
      }
      if (member({
              hd: _hd1,
              tl: {
                hd: _hd2,
                tl: {
                  hd: _hd3,
                  tl: {
                    hd: hd4,
                    tl: /* [] */0
                  }
                }
              }
            }, {
              hd: 2,
              tl: /* [] */0
            })) {
        _num = num - 10;
        _lst = {
          hd: _hd2,
          tl: {
            hd: _hd3,
            tl: {
              hd: hd4,
              tl: tl
            }
          }
        };
        continue ;
      }
      _lst = {
        hd: _hd2,
        tl: {
          hd: _hd3,
          tl: {
            hd: hd4,
            tl: tl
          }
        }
      };
      continue ;
    };
  };
  return score(lst.tl, num, n) + search(lst.hd, 0, n);
}

function estimateValue(inState) {
  var match = inState._0;
  if (typeof match === "number") {
    return 0;
  }
  if (match.TAG === /* Win */0) {
    if (match._0) {
      return -100000000000000000000000000;
    } else {
      return 100000000000000000000000000;
    }
  }
  var board = inState._1;
  return score(board, 0, 1) + 1.5 * score(transpose(board), 0, 1) + 2 * (score(transpose(shear(board)), 0, 1) + score(transpose(shear(List.map(List.rev, board))), 0, 1)) + score(board, 0, 2) + 1.5 * score(transpose(board), 0, 2) + 2 * (score(transpose(shear(board)), 0, 2) + score(transpose(shear(List.map(List.rev, board))), 0, 2));
}

var Connect4 = {
  transpose: transpose,
  duplicate: duplicate,
  shear: shear,
  initialState: initialState,
  stringOfPlayer: stringOfPlayer,
  stringOfState: stringOfState,
  stringOfMove: stringOfMove,
  legalMoves: legalMoves,
  gameStatus: gameStatus,
  nextState: nextState,
  moveOfString: moveOfString,
  score: score,
  estimateValue: estimateValue
};

CS17SetupGame$Game.checkExpect(transpose({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: /* [] */0
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                },
                tl: /* [] */0
              }
            }
          }
        }), {
      hd: {
        hd: 0,
        tl: {
          hd: 0,
          tl: {
            hd: 0,
            tl: {
              hd: 0,
              tl: /* [] */0
            }
          }
        }
      },
      tl: {
        hd: {
          hd: 0,
          tl: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          }
        },
        tl: /* [] */0
      }
    }, "2*4");

CS17SetupGame$Game.checkExpect(transpose({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: /* [] */0
                          }
                        }
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: /* [] */0
                            }
                          }
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }), {
      hd: {
        hd: 0,
        tl: {
          hd: 0,
          tl: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          }
        }
      },
      tl: {
        hd: {
          hd: 0,
          tl: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            }
          }
        },
        tl: {
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          }
        }
      }
    }, "6*5");

CS17SetupGame$Game.checkExpect(transpose({
          hd: {
            hd: 0,
            tl: /* [] */0
          },
          tl: {
            hd: {
              hd: 0,
              tl: /* [] */0
            },
            tl: /* [] */0
          }
        }), {
      hd: {
        hd: 0,
        tl: {
          hd: 0,
          tl: /* [] */0
        }
      },
      tl: /* [] */0
    }, "1*2");

CS17SetupGame$Game.checkError((function (param) {
        return transpose(/* [] */0);
      }), "A matrix cannot be 0-dimensional.");

CS17SetupGame$Game.checkError((function (param) {
        return transpose({
                    hd: /* [] */0,
                    tl: {
                      hd: /* [] */0,
                      tl: /* [] */0
                    }
                  });
      }), "A matrix cannot be 0-dimensional.");

CS17SetupGame$Game.checkExpect(duplicate("a", 3), {
      hd: "a",
      tl: {
        hd: "a",
        tl: {
          hd: "a",
          tl: /* [] */0
        }
      }
    }, "duplicate a 3 times");

CS17SetupGame$Game.checkExpect(duplicate("a", 0), /* [] */0, "duplicate a 0 times");

CS17SetupGame$Game.checkExpect(duplicate(2, 5), {
      hd: 2,
      tl: {
        hd: 2,
        tl: {
          hd: 2,
          tl: {
            hd: 2,
            tl: {
              hd: 2,
              tl: /* [] */0
            }
          }
        }
      }
    }, "duplicate 2 5 times");

CS17SetupGame$Game.checkExpect(shear({
          hd: {
            hd: 1,
            tl: {
              hd: 1,
              tl: /* [] */0
            }
          },
          tl: /* [] */0
        }), {
      hd: {
        hd: 1,
        tl: {
          hd: 1,
          tl: /* [] */0
        }
      },
      tl: /* [] */0
    }, "shear 1");

CS17SetupGame$Game.checkExpect(shear({
          hd: {
            hd: 1,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              },
              tl: /* [] */0
            }
          }
        }), {
      hd: {
        hd: 1,
        tl: {
          hd: 1,
          tl: {
            hd: 1,
            tl: {
              hd: 3,
              tl: {
                hd: 3,
                tl: /* [] */0
              }
            }
          }
        }
      },
      tl: {
        hd: {
          hd: 3,
          tl: {
            hd: 1,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 3,
                  tl: /* [] */0
                }
              }
            }
          }
        },
        tl: {
          hd: {
            hd: 3,
            tl: {
              hd: 3,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              }
            }
          },
          tl: /* [] */0
        }
      }
    }, "shear 2");

CS17SetupGame$Game.checkError((function (param) {
        return shear(/* [] */0);
      }), "A matrix cannot be 0-dimensional.");

CS17SetupGame$Game.checkError((function (param) {
        return shear({
                    hd: /* [] */0,
                    tl: {
                      hd: /* [] */0,
                      tl: /* [] */0
                    }
                  });
      }), "A matrix cannot be 0-dimensional.");

CS17SetupGame$Game.checkExpect(initialState("2 4"), /* State */{
      _0: {
        TAG: /* Ongoing */1,
        _0: /* P1 */0
      },
      _1: {
        hd: {
          hd: 0,
          tl: {
            hd: 0,
            tl: /* [] */0
          }
        },
        tl: {
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: /* [] */0
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              },
              tl: /* [] */0
            }
          }
        }
      }
    }, "2*4 board");

CS17SetupGame$Game.checkExpect(initialState("6 5"), /* State */{
      _0: {
        TAG: /* Ongoing */1,
        _0: /* P1 */0
      },
      _1: {
        hd: {
          hd: 0,
          tl: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            }
          }
        },
        tl: {
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: /* [] */0
                          }
                        }
                      }
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          }
        }
      }
    }, "6*5 board");

CS17SetupGame$Game.checkExpect("Player1", "Player1", "player 1");

CS17SetupGame$Game.checkExpect("Player2", "Player2", "player 1");

CS17SetupGame$Game.checkExpect(stringOfState(/* State */{
          _0: {
            TAG: /* Ongoing */1,
            _0: /* P1 */0
          },
          _1: {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: /* [] */0
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }), "1 0 0 0\n1 1 1 0\n", "2*4");

CS17SetupGame$Game.checkExpect(stringOfState(/* State */{
          _0: /* Draw */0,
          _1: {
            hd: {
              hd: 1,
              tl: {
                hd: 2,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 2,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 1,
                      tl: /* [] */0
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          }
        }), "1 2 1\n2 1 2\n1 2 1\n", "3*3");

CS17SetupGame$Game.checkExpect(String(2), "2", "stringOfMove2");

CS17SetupGame$Game.checkExpect(String(7), "7", "stringOfMove7");

CS17SetupGame$Game.checkExpect(legalMoves(/* State */{
          _0: {
            TAG: /* Ongoing */1,
            _0: /* P1 */0
          },
          _1: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }), {
      hd: /* Move */{
        _0: 1
      },
      tl: {
        hd: /* Move */{
          _0: 2
        },
        tl: {
          hd: /* Move */{
            _0: 3
          },
          tl: {
            hd: /* Move */{
              _0: 4
            },
            tl: /* [] */0
          }
        }
      }
    }, "legal move for  2*4 board1");

CS17SetupGame$Game.checkExpect(legalMoves(/* State */{
          _0: {
            TAG: /* Ongoing */1,
            _0: /* P1 */0
          },
          _1: {
            hd: {
              hd: 1,
              tl: {
                hd: 2,
                tl: /* [] */0
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }), {
      hd: /* Move */{
        _0: 2
      },
      tl: {
        hd: /* Move */{
          _0: 3
        },
        tl: {
          hd: /* Move */{
            _0: 4
          },
          tl: /* [] */0
        }
      }
    }, "legal move for  2*4 board2");

CS17SetupGame$Game.checkExpect(legalMoves(/* State */{
          _0: {
            TAG: /* Ongoing */1,
            _0: /* P1 */0
          },
          _1: {
            hd: {
              hd: 1,
              tl: /* [] */0
            },
            tl: {
              hd: {
                hd: 1,
                tl: /* [] */0
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: /* [] */0
                },
                tl: /* [] */0
              }
            }
          }
        }), /* [] */0, "legal move for  1*3 board");

CS17SetupGame$Game.checkExpect({
      TAG: /* Ongoing */1,
      _0: /* P1 */0
    }, {
      TAG: /* Ongoing */1,
      _0: /* P1 */0
    }, "ongoing player 1");

CS17SetupGame$Game.checkExpect({
      TAG: /* Ongoing */1,
      _0: /* P2 */1
    }, {
      TAG: /* Ongoing */1,
      _0: /* P2 */1
    }, "ongoing player 2");

CS17SetupGame$Game.checkExpect(nextState(/* State */{
          _0: {
            TAG: /* Win */0,
            _0: /* P1 */0
          },
          _1: {
            hd: {
              hd: 1,
              tl: {
                hd: 2,
                tl: /* [] */0
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 2,
                  tl: /* [] */0
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                },
                tl: {
                  hd: {
                    hd: 1,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }, /* Move */{
          _0: 2
        }), /* State */{
      _0: {
        TAG: /* Win */0,
        _0: /* P1 */0
      },
      _1: {
        hd: {
          hd: 1,
          tl: {
            hd: 2,
            tl: /* [] */0
          }
        },
        tl: {
          hd: {
            hd: 1,
            tl: {
              hd: 2,
              tl: /* [] */0
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 2,
                tl: /* [] */0
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              },
              tl: /* [] */0
            }
          }
        }
      }
    }, "already winp1");

CS17SetupGame$Game.checkExpect(nextState(/* State */{
          _0: /* Draw */0,
          _1: {
            hd: {
              hd: 1,
              tl: {
                hd: 2,
                tl: /* [] */0
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 2,
                  tl: /* [] */0
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                },
                tl: {
                  hd: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }, /* Move */{
          _0: 3
        }), /* State */{
      _0: /* Draw */0,
      _1: {
        hd: {
          hd: 1,
          tl: {
            hd: 2,
            tl: /* [] */0
          }
        },
        tl: {
          hd: {
            hd: 1,
            tl: {
              hd: 2,
              tl: /* [] */0
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 2,
                tl: /* [] */0
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 2,
                  tl: /* [] */0
                }
              },
              tl: /* [] */0
            }
          }
        }
      }
    }, "already draw");

CS17SetupGame$Game.checkExpect(nextState(/* State */{
          _0: {
            TAG: /* Ongoing */1,
            _0: /* P1 */0
          },
          _1: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }, /* Move */{
          _0: 1
        }), /* State */{
      _0: {
        TAG: /* Ongoing */1,
        _0: /* P2 */1
      },
      _1: {
        hd: {
          hd: 1,
          tl: {
            hd: 0,
            tl: /* [] */0
          }
        },
        tl: {
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: /* [] */0
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              },
              tl: /* [] */0
            }
          }
        }
      }
    }, "ongoing1");

CS17SetupGame$Game.checkExpect(nextState(/* State */{
          _0: {
            TAG: /* Ongoing */1,
            _0: /* P2 */1
          },
          _1: {
            hd: {
              hd: 1,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }, /* Move */{
          _0: 3
        }), /* State */{
      _0: {
        TAG: /* Ongoing */1,
        _0: /* P1 */0
      },
      _1: {
        hd: {
          hd: 1,
          tl: {
            hd: 0,
            tl: /* [] */0
          }
        },
        tl: {
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: /* [] */0
            }
          },
          tl: {
            hd: {
              hd: 2,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              },
              tl: /* [] */0
            }
          }
        }
      }
    }, "ongoing2");

CS17SetupGame$Game.checkExpect(nextState(/* State */{
          _0: {
            TAG: /* Ongoing */1,
            _0: /* P1 */0
          },
          _1: {
            hd: {
              hd: 1,
              tl: {
                hd: 2,
                tl: /* [] */0
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 2,
                  tl: /* [] */0
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }, /* Move */{
          _0: 4
        }), /* State */{
      _0: {
        TAG: /* Win */0,
        _0: /* P1 */0
      },
      _1: {
        hd: {
          hd: 1,
          tl: {
            hd: 2,
            tl: /* [] */0
          }
        },
        tl: {
          hd: {
            hd: 1,
            tl: {
              hd: 2,
              tl: /* [] */0
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 2,
                tl: /* [] */0
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              },
              tl: /* [] */0
            }
          }
        }
      }
    }, "win horizontal");

CS17SetupGame$Game.checkExpect(nextState(/* State */{
          _0: {
            TAG: /* Ongoing */1,
            _0: /* P2 */1
          },
          _1: {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: /* [] */0
                          }
                        }
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 2,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: /* [] */0
                            }
                          }
                        }
                      }
                    }
                  },
                  tl: {
                    hd: {
                      hd: 2,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: {
                                hd: 0,
                                tl: /* [] */0
                              }
                            }
                          }
                        }
                      }
                    },
                    tl: /* [] */0
                  }
                }
              }
            }
          }
        }, /* Move */{
          _0: 3
        }), /* State */{
      _0: {
        TAG: /* Win */0,
        _0: /* P2 */1
      },
      _1: {
        hd: {
          hd: 1,
          tl: {
            hd: 1,
            tl: {
              hd: 1,
              tl: {
                hd: 2,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            }
          }
        },
        tl: {
          hd: {
            hd: 1,
            tl: {
              hd: 1,
              tl: {
                hd: 2,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 2,
              tl: {
                hd: 2,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 2,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: /* [] */0
                          }
                        }
                      }
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          }
        }
      }
    }, "win diagonal");

CS17SetupGame$Game.checkExpect(nextState(/* State */{
          _0: {
            TAG: /* Ongoing */1,
            _0: /* P1 */0
          },
          _1: {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: /* [] */0
                          }
                        }
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 2,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: /* [] */0
                            }
                          }
                        }
                      }
                    }
                  },
                  tl: {
                    hd: {
                      hd: 2,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: {
                                hd: 0,
                                tl: /* [] */0
                              }
                            }
                          }
                        }
                      }
                    },
                    tl: /* [] */0
                  }
                }
              }
            }
          }
        }, /* Move */{
          _0: 1
        }), /* State */{
      _0: {
        TAG: /* Win */0,
        _0: /* P1 */0
      },
      _1: {
        hd: {
          hd: 1,
          tl: {
            hd: 1,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            }
          }
        },
        tl: {
          hd: {
            hd: 1,
            tl: {
              hd: 2,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 2,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 2,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: /* [] */0
                          }
                        }
                      }
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          }
        }
      }
    }, "win vertical");

CS17SetupGame$Game.checkExpect(nextState(/* State */{
          _0: {
            TAG: /* Ongoing */1,
            _0: /* P2 */1
          },
          _1: {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: /* [] */0
              }
            },
            tl: {
              hd: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: /* [] */0
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                },
                tl: {
                  hd: {
                    hd: 1,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }, /* Move */{
          _0: 4
        }), /* State */{
      _0: /* Draw */0,
      _1: {
        hd: {
          hd: 1,
          tl: {
            hd: 1,
            tl: /* [] */0
          }
        },
        tl: {
          hd: {
            hd: 2,
            tl: {
              hd: 2,
              tl: /* [] */0
            }
          },
          tl: {
            hd: {
              hd: 2,
              tl: {
                hd: 1,
                tl: /* [] */0
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 2,
                  tl: /* [] */0
                }
              },
              tl: /* [] */0
            }
          }
        }
      }
    }, "draw");

CS17SetupGame$Game.checkError((function (param) {
        return nextState(/* State */{
                    _0: {
                      TAG: /* Ongoing */1,
                      _0: /* P2 */1
                    },
                    _1: {
                      hd: {
                        hd: 1,
                        tl: {
                          hd: 1,
                          tl: /* [] */0
                        }
                      },
                      tl: {
                        hd: {
                          hd: 2,
                          tl: {
                            hd: 2,
                            tl: /* [] */0
                          }
                        },
                        tl: {
                          hd: {
                            hd: 2,
                            tl: {
                              hd: 1,
                              tl: /* [] */0
                            }
                          },
                          tl: {
                            hd: {
                              hd: 1,
                              tl: {
                                hd: 0,
                                tl: /* [] */0
                              }
                            },
                            tl: /* [] */0
                          }
                        }
                      }
                    }
                  }, /* Move */{
                    _0: 1
                  });
      }), "invalid move");

CS17SetupGame$Game.checkExpect(moveOfString("2", /* State */{
          _0: {
            TAG: /* Ongoing */1,
            _0: /* P2 */1
          },
          _1: {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: /* [] */0
                          }
                        }
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 2,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: /* [] */0
                            }
                          }
                        }
                      }
                    }
                  },
                  tl: {
                    hd: {
                      hd: 2,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: {
                                hd: 0,
                                tl: /* [] */0
                              }
                            }
                          }
                        }
                      }
                    },
                    tl: /* [] */0
                  }
                }
              }
            }
          }
        }), /* Move */{
      _0: 2
    }, "move of string");

CS17SetupGame$Game.checkError((function (param) {
        return moveOfString("2", /* State */{
                    _0: {
                      TAG: /* Ongoing */1,
                      _0: /* P2 */1
                    },
                    _1: {
                      hd: {
                        hd: 1,
                        tl: {
                          hd: 1,
                          tl: {
                            hd: 1,
                            tl: {
                              hd: 2,
                              tl: {
                                hd: 0,
                                tl: {
                                  hd: 0,
                                  tl: /* [] */0
                                }
                              }
                            }
                          }
                        }
                      },
                      tl: {
                        hd: {
                          hd: 1,
                          tl: {
                            hd: 1,
                            tl: {
                              hd: 2,
                              tl: {
                                hd: 1,
                                tl: {
                                  hd: 2,
                                  tl: {
                                    hd: 1,
                                    tl: /* [] */0
                                  }
                                }
                              }
                            }
                          }
                        },
                        tl: {
                          hd: {
                            hd: 2,
                            tl: {
                              hd: 0,
                              tl: {
                                hd: 0,
                                tl: {
                                  hd: 0,
                                  tl: {
                                    hd: 0,
                                    tl: {
                                      hd: 0,
                                      tl: /* [] */0
                                    }
                                  }
                                }
                              }
                            }
                          },
                          tl: {
                            hd: {
                              hd: 2,
                              tl: {
                                hd: 1,
                                tl: {
                                  hd: 0,
                                  tl: {
                                    hd: 0,
                                    tl: {
                                      hd: 0,
                                      tl: {
                                        hd: 0,
                                        tl: /* [] */0
                                      }
                                    }
                                  }
                                }
                              }
                            },
                            tl: {
                              hd: {
                                hd: 2,
                                tl: {
                                  hd: 0,
                                  tl: {
                                    hd: 0,
                                    tl: {
                                      hd: 0,
                                      tl: {
                                        hd: 0,
                                        tl: {
                                          hd: 0,
                                          tl: /* [] */0
                                        }
                                      }
                                    }
                                  }
                                }
                              },
                              tl: /* [] */0
                            }
                          }
                        }
                      }
                    }
                  });
      }), "not a legal move");

CS17SetupGame$Game.checkExpect(score({
          hd: {
            hd: 1,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 2,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: /* [] */0
                          }
                        }
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 2,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: /* [] */0
                            }
                          }
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }, 0, 1), 10, "P1");

CS17SetupGame$Game.checkExpect(score({
          hd: {
            hd: 1,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 2,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 2,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: /* [] */0
                          }
                        }
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 2,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: /* [] */0
                            }
                          }
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }, 0, 1), 500110, "P1");

CS17SetupGame$Game.checkExpect(score({
          hd: {
            hd: 1,
            tl: {
              hd: 1,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 2,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: /* [] */0
                          }
                        }
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 2,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: /* [] */0
                            }
                          }
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }, 0, 1), 120, "P1");

CS17SetupGame$Game.checkExpect(score({
          hd: {
            hd: 1,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 2,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: /* [] */0
                          }
                        }
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 2,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: /* [] */0
                            }
                          }
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }, 0, 2), -30, "P2");

CS17SetupGame$Game.checkExpect(score({
          hd: {
            hd: 1,
            tl: {
              hd: 1,
              tl: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 2,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: /* [] */0
                          }
                        }
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 2,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: /* [] */0
                            }
                          }
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }, 0, 2), -130, "P2");

CS17SetupGame$Game.checkError((function (param) {
        return score({
                    hd: {
                      hd: 1,
                      tl: {
                        hd: 1,
                        tl: /* [] */0
                      }
                    },
                    tl: {
                      hd: {
                        hd: 2,
                        tl: {
                          hd: 2,
                          tl: /* [] */0
                        }
                      },
                      tl: {
                        hd: {
                          hd: 2,
                          tl: {
                            hd: 1,
                            tl: /* [] */0
                          }
                        },
                        tl: {
                          hd: {
                            hd: 1,
                            tl: {
                              hd: 0,
                              tl: /* [] */0
                            }
                          },
                          tl: /* [] */0
                        }
                      }
                    }
                  }, 0, 1);
      }), "the list is too short");

CS17SetupGame$Game.checkError((function (param) {
        return score({
                    hd: {
                      hd: 1,
                      tl: {
                        hd: 1,
                        tl: {
                          hd: 2,
                          tl: {
                            hd: 2,
                            tl: {
                              hd: 0,
                              tl: {
                                hd: 0,
                                tl: /* [] */0
                              }
                            }
                          }
                        }
                      }
                    },
                    tl: {
                      hd: {
                        hd: 1,
                        tl: {
                          hd: 1,
                          tl: {
                            hd: 2,
                            tl: {
                              hd: 0,
                              tl: {
                                hd: 0,
                                tl: {
                                  hd: 0,
                                  tl: /* [] */0
                                }
                              }
                            }
                          }
                        }
                      },
                      tl: {
                        hd: {
                          hd: 2,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: {
                                hd: 0,
                                tl: {
                                  hd: 0,
                                  tl: {
                                    hd: 0,
                                    tl: /* [] */0
                                  }
                                }
                              }
                            }
                          }
                        },
                        tl: {
                          hd: {
                            hd: 2,
                            tl: {
                              hd: 1,
                              tl: {
                                hd: 1,
                                tl: {
                                  hd: 0,
                                  tl: {
                                    hd: 0,
                                    tl: {
                                      hd: 0,
                                      tl: /* [] */0
                                    }
                                  }
                                }
                              }
                            }
                          },
                          tl: {
                            hd: {
                              hd: 2,
                              tl: {
                                hd: 0,
                                tl: {
                                  hd: 0,
                                  tl: {
                                    hd: 0,
                                    tl: {
                                      hd: 0,
                                      tl: {
                                        hd: 0,
                                        tl: /* [] */0
                                      }
                                    }
                                  }
                                }
                              }
                            },
                            tl: /* [] */0
                          }
                        }
                      }
                    }
                  }, 0, 3);
      }), "there are only 2 players");

CS17SetupGame$Game.checkExpect(estimateValue(/* State */{
          _0: {
            TAG: /* Ongoing */1,
            _0: /* P2 */1
          },
          _1: {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: /* [] */0
                          }
                        }
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 2,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: /* [] */0
                            }
                          }
                        }
                      }
                    }
                  },
                  tl: {
                    hd: {
                      hd: 2,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: {
                                hd: 0,
                                tl: /* [] */0
                              }
                            }
                          }
                        }
                      }
                    },
                    tl: /* [] */0
                  }
                }
              }
            }
          }
        }), -49660, "P2");

CS17SetupGame$Game.checkExpect(estimateValue(/* State */{
          _0: {
            TAG: /* Ongoing */1,
            _0: /* P1 */0
          },
          _1: {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: /* [] */0
                          }
                        }
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 2,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: /* [] */0
                            }
                          }
                        }
                      }
                    }
                  },
                  tl: {
                    hd: {
                      hd: 2,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: {
                                hd: 0,
                                tl: /* [] */0
                              }
                            }
                          }
                        }
                      }
                    },
                    tl: /* [] */0
                  }
                }
              }
            }
          }
        }), 500010, "P1");

CS17SetupGame$Game.checkExpect(estimateValue(/* State */{
          _0: {
            TAG: /* Ongoing */1,
            _0: /* P1 */0
          },
          _1: {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: /* [] */0
                          }
                        }
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 2,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: /* [] */0
                            }
                          }
                        }
                      }
                    }
                  },
                  tl: {
                    hd: {
                      hd: 2,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: {
                                hd: 0,
                                tl: /* [] */0
                              }
                            }
                          }
                        }
                      }
                    },
                    tl: /* [] */0
                  }
                }
              }
            }
          }
        }), 225, "P1");

CS17SetupGame$Game.checkExpect(estimateValue(/* State */{
          _0: {
            TAG: /* Win */0,
            _0: /* P1 */0
          },
          _1: {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 2,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: /* [] */0
                          }
                        }
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 2,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: /* [] */0
                            }
                          }
                        }
                      }
                    }
                  },
                  tl: {
                    hd: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: {
                                hd: 0,
                                tl: /* [] */0
                              }
                            }
                          }
                        }
                      }
                    },
                    tl: /* [] */0
                  }
                }
              }
            }
          }
        }), 100000000000000000000000000, "P1");

CS17SetupGame$Game.checkExpect(estimateValue(/* State */{
          _0: {
            TAG: /* Win */0,
            _0: /* P2 */1
          },
          _1: {
            hd: {
              hd: 2,
              tl: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: /* [] */0
                          }
                        }
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 1,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: /* [] */0
                            }
                          }
                        }
                      }
                    }
                  },
                  tl: {
                    hd: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: {
                                hd: 0,
                                tl: /* [] */0
                              }
                            }
                          }
                        }
                      }
                    },
                    tl: /* [] */0
                  }
                }
              }
            }
          }
        }), -100000000000000000000000000, "P2");

CS17SetupGame$Game.checkError((function (param) {
        return estimateValue(/* State */{
                    _0: {
                      TAG: /* Ongoing */1,
                      _0: /* P2 */1
                    },
                    _1: {
                      hd: {
                        hd: 1,
                        tl: {
                          hd: 1,
                          tl: /* [] */0
                        }
                      },
                      tl: {
                        hd: {
                          hd: 2,
                          tl: {
                            hd: 2,
                            tl: /* [] */0
                          }
                        },
                        tl: {
                          hd: {
                            hd: 2,
                            tl: {
                              hd: 1,
                              tl: /* [] */0
                            }
                          },
                          tl: {
                            hd: {
                              hd: 1,
                              tl: {
                                hd: 0,
                                tl: /* [] */0
                              }
                            },
                            tl: /* [] */0
                          }
                        }
                      }
                    }
                  });
      }), "the list is too short");

var MyGame = {
  stringOfPlayer: stringOfPlayer,
  stringOfState: stringOfState,
  stringOfMove: stringOfMove,
  initialState: initialState,
  legalMoves: legalMoves,
  gameStatus: gameStatus,
  nextState: nextState,
  moveOfString: moveOfString,
  estimateValue: estimateValue
};

exports.Connect4 = Connect4;
exports.MyGame = MyGame;
/*  Not a pure module */
